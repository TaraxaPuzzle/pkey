<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>WalletConnect Demo</title>

<!-- Ethers.js -->
<script src="https://cdn.jsdelivr.net/npm/ethers@6.8.1/dist/ethers.umd.min.js"></script>

<!-- Web3Modal v2 -->
<script src="https://unpkg.com/@web3modal/html@2.3.4/dist/index.min.js"></script>
<script src="https://unpkg.com/@web3modal/ethereum@2.3.4/dist/index.min.js"></script>

<style>
  body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
  #walletAddress { margin-top: 20px; }
</style>
</head>
<body>

<h1>WalletConnect Demo</h1>
<button id="connectBtn">Connect Wallet</button>
<div id="walletAddress"></div>

<script>
  const chains = [
    {
      id: 841,
      name: "Taraxa Mainnet",
      network: "taraxa",
      nativeCurrency: { decimals: 18, name: "Tara", symbol: "TARA" },
      rpcUrls: { default: ["https://rpc.mainnet.taraxa.io"] },
      blockExplorers: { default: { name: "Taraxa Explorer", url: "https://explorer.mainnet.taraxa.io" } }
    }
  ];

  const projectId = "c3bca9309d970d96c70be0b04f661798";

  // Instantiate classes directly
  const web3modalEthereum = new Web3ModalEthereum({
    projectId,
    chains
  });

  const web3modal = new Web3Modal({
    themeMode: "light",
    ethereum: web3modalEthereum
  });

  let provider, signer;

  async function connectWallet() {
    try {
      await web3modal.openModal();
      provider = new ethers.BrowserProvider(web3modalEthereum);
      await provider.send("eth_requestAccounts", []);
      signer = await provider.getSigner();
      const address = await signer.getAddress();
      document.getElementById("walletAddress").innerText = "Connected wallet: " + address;
      console.log("Connected wallet:", address);
    } catch (e) {
      console.error("Connect error:", e);
      alert("Failed to connect wallet");
    }
  }

  document.getElementById("connectBtn").onclick = connectWallet;
</script>

</body>
</html>
