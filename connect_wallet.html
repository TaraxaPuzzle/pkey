<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Fomo.biz Style Wallet Connect Demo</title>

<!-- Ethers.js -->
<script src="https://cdn.jsdelivr.net/npm/ethers@6.8.1/dist/ethers.umd.min.js"></script>

<!-- Web3Modal v2 -->
<script src="https://unpkg.com/@web3modal/html@2.3.4/dist/index.min.js"></script>
<script src="https://unpkg.com/@web3modal/ethereum@2.3.4/dist/index.min.js"></script>

<!-- Wagmi Core -->
<script src="https://unpkg.com/@wagmi/core@0.10.1/dist/index.min.js"></script>

<style>
  body {
    max-width: 400px;
    margin: 40px auto;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f8f9fa;
    padding: 30px;
    border-radius: 16px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
    text-align: center;
  }
  h1 {
    color: #343a40;
    margin-bottom: 1rem;
  }
  button {
    padding: 12px 24px;
    font-size: 1rem;
    border: none;
    border-radius: 8px;
    background-color: #0d6efd;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  button:hover {
    background-color: #0b5ed7;
  }
  #walletAddress {
    margin-top: 20px;
    font-size: 1.1rem;
    color: #198754;
    word-break: break-word;
  }
  #networkStatus {
    margin-top: 10px;
    font-size: 0.9rem;
    color: #198754;
    display: none;
  }
</style>
</head>
<body>

<h1>Connect Wallet (Fomo.biz Style)</h1>
<button id="connectBtn">Connect Wallet</button>
<div id="walletAddress"></div>
<div id="networkStatus">âœ… Connected to Taraxa Mainnet</div>

<script>
  const chains = [
    {
      id: 841,
      name: "Taraxa Mainnet",
      network: "taraxa",
      nativeCurrency: { decimals: 18, name: "Tara", symbol: "TARA" },
      rpcUrls: { default: ["https://rpc.mainnet.taraxa.io"] },
      blockExplorers: { default: { name: "Taraxa Explorer", url: "https://explorer.mainnet.taraxa.io" } }
    }
  ];

  const projectId = "c3bca9309d970d96c70be0b04f661798"; // WalletConnect Cloud Project ID

  // Wagmi Core objects from the global import
  const { w3mConnectors, w3mProvider, EthereumClient } = window.WagmiCore;
  const { Web3Modal } = window.Web3Modal;

  // Setup Wagmi provider and connectors for WalletConnect Cloud
  const wagmiProvider = w3mProvider({ projectId, chains });
  const wagmiConnectors = w3mConnectors({ projectId, chains });

  // Ethereum client bridge for Web3Modal
  const ethereumClient = new EthereumClient(wagmiProvider, wagmiConnectors);

  // Initialize Web3Modal with Ethereum client
  const web3Modal = new Web3Modal({
    projectId,
    ethereumClient,
    themeMode: "light"
  });

  let provider, signer;

  async function connectWallet() {
    try {
      // Open wallet selection modal
      await web3Modal.open();

      // Get ethers provider from ethereumClient's provider
      provider = new ethers.BrowserProvider(ethereumClient.getProvider());

      // Request accounts
      await provider.send("eth_requestAccounts", []);

      // Get signer and address
      signer = await provider.getSigner();
      const address = await signer.getAddress();

      // Display wallet info
      document.getElementById("walletAddress").innerText = "Connected wallet: " + address;
      document.getElementById("networkStatus").style.display = "block";

      console.log("Connected wallet:", address);
    } catch (err) {
      console.error("Wallet connection failed:", err);
      alert("Failed to connect wallet. Please try again.");
    }
  }

  document.getElementById("connectBtn").onclick = connectWallet;
</script>

</body>
</html>
