<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8" /><title>Enkrypt Taraxa Connect</title></head>
<body>
<button id="connectBtn">Connect Enkrypt + Add Taraxa</button>
<div id="status"></div>
<script src="https://cdn.jsdelivr.net/npm/ethers@6.8.1/dist/ethers.umd.min.js"></script>
<script>
  const btn = document.getElementById("connectBtn");
  const status = document.getElementById("status");

  btn.onclick = async () => {
    status.innerText = "Checking Enkrypt wallet...";
    if (!window.enkrypt || !window.enkrypt.ethereum) {
      status.innerText = "Enkrypt wallet not detected. Please install or enable it.";
      return;
    }
    const provider = new ethers.BrowserProvider(window.enkrypt.ethereum);
    try {
      status.innerText = "Requesting account access...";
      await provider.send("eth_requestAccounts", []);
      const signer = await provider.getSigner();
      const address = await signer.getAddress();
      status.innerText = `Connected: ${address}\nAdding Taraxa network...`;

      const taraxaChain = {
        chainId: "0x349",
        chainName: "Taraxa Mainnet",
        nativeCurrency: { name: "Tara", symbol: "TARA", decimals: 18 },
        rpcUrls: ["https://rpc.mainnet.taraxa.io"],
        blockExplorerUrls: ["https://explorer.mainnet.taraxa.io"]
      };

      await provider.send("wallet_addEthereumChain", [taraxaChain]);
      status.innerText += "\nTaraxa network added/switched successfully!";
    } catch (err) {
      console.error(err);
      status.innerText = "Error: " + err.message;
    }
  };
</script>
</body>
</html>
